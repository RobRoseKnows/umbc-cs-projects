# Homework 2

Robert Rose

## Problem 1

Exercises 3.1 and 3.2 (20 pts) from the DSC textbook

### Exercise 3.1

Write the following queries in SQL , using the university schema.

All of these queries were followed by the query `USE university;` I didn't include
it in each snippet because it would've been redundant.

#### a. 

Find the titles of courses in the Comp. Sci. department that have 3 credits.

```sql
SELECT title FROM course 
WHERE dept_name='Comp. Sci.' AND credits=3;
```

#### b. 

Find the ID s of all students who were taught by an instructor named Einstein; 
make sure there are no duplicates in the result.

```sql
SELECT DISTINCT takes.ID FROM takes 
INNER JOIN  (instructor INNER JOIN teaches using(ID))
USING(course_id, sec_id, semester, year)
WHERE instructor.name = 'Einstein';
```

#### c.

Find the highest salary of any instructor.

```sql
SELECT max(salary) FROM instructor;
```

#### d.

Find all instructors earning the highest salary (there may be more than one with 
the same salary).

```sql
SELECT ID, name FROM instructor
WHERE salary = (SELECT max(salary) FROM instructor);
```

#### e. 

Find the enrollment of each section that was offered in Autumn 2009.

```sql
USE university;
SELECT course_id, sec_id, COUNT(takes.ID)
FROM (section INNER JOIN takes USING(course_id, sec_id, semester, year))
-- "Autumn" is not in the example database, so I assume they meant "Fall"
WHERE semester = 'Fall' 
AND year = 2009
GROUP BY course_id, sec_id;
```

#### f.

Find the maximum enrollment, across all sections, in Autumn 2009.

```sql
SELECT max(Enrollment) AS MAX_ENROLL
FROM
(SELECT course_id, sec_id, COUNT(takes.ID) AS Enrollment
FROM (section INNER JOIN takes USING(course_id, sec_id, semester, year))
-- "Autumn" is not in the example database, so I assume they meant "Fall"
WHERE semester = 'Fall'
AND year = 2009
GROUP BY course_id, sec_id) AS NEW_TABLE;
```

#### g.

Find the sections that had the maximum enrollment in Autumn 2009.

```sql
SELECT course_id, sec_id FROM
(SELECT course_id, sec_id, COUNT(takes.ID) AS Enrollment
	FROM (section INNER JOIN takes USING(course_id, sec_id, semester, year))
-- "Autumn" is not in the example database, so I assume they meant "Fall"
WHERE semester = 'Fall'
AND year = 2009
GROUP BY course_id, sec_id) AS NEW_TABLE
WHERE Enrollment >= max(Enrollment);
```
